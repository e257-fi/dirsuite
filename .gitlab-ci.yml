### vim: tabstop=2 shiftwidth=2 softtabstop=2 smarttab expandtab autoindent
###
### E257.FI: dirsuite
### https://gitlab.com/e257/testing/dirsuite
###
cache:
  key: "$CI_BUILD_REF_NAME"
  untracked: true
  paths:
    - "sbt-cache/ivy/cache"
    - "sbt-cache/boot"
    - "sbt-cache/sbtboot"

test·jdk11:
  image: "hseeberger/scala-sbt:11.0.4_1.3.2_2.13.1"

  variables:
    SBT_OPTS: "-Dsbt.global.base=sbt-cache/sbtboot -Dsbt.boot.directory=sbt-cache/boot -Dsbt.ivy.home=sbt-cache/ivy"

  stage: "test"

  script:
    - sbt "+clean" "+test"


test·jdk8:
  image: "hseeberger/scala-sbt:8u222_1.3.2_2.13.1"

  variables:
    SBT_OPTS: "-Dsbt.global.base=sbt-cache/sbtboot -Dsbt.boot.directory=sbt-cache/boot -Dsbt.ivy.home=sbt-cache/ivy"

  stage: "test"

  script:
    - sbt "+clean" "+test"

###
### Disable coverate until 
### https://github.com/scoverage/sbt-scoverage/issues/295 
### is fixed
###
#codecov:
#  image: "hseeberger/scala-sbt:8u222_1.3.2_2.13.1"
#
#  stage: "test"
#
#  script:
#    - sbt "+clean" coverage "++2.13.1! test"
#    - sbt "++2.13.1! coverageAggregate"
#
#  coverage: '/All done. Coverage was \[\d+.\d+%\]/'
